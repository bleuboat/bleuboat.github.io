<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script>
        // 解析URL参数
        const params = new URLSearchParams(window.location.search);
        const name = params.get('name');
        
        // 准备响应数据
        let response;
        if (name) {
            response = {
                "success": true,
                "message": `Hello, ${name}!`,
                "received_name": name,
                "length": name.length,
                "uppercase": name.toUpperCase(),
                "lowercase": name.toLowerCase(),
                "timestamp": new Date().toISOString()
            };
        } else {
            response = {
                "success": false,
                "error": "请提供name参数",
                "usage": "https://bleuboat.github.io/api.html?name=example",
                "timestamp": new Date().toISOString()
            };
        }
        
        // 将JSON数据转换为字符串
        const jsonStr = JSON.stringify(response, null, 2);
        
        // 尝试设置正确的响应头（在GitHub Pages上可能有限制）
        if (window.parent && window.parent.postMessage) {
            window.parent.postMessage({
                type: 'jsonResponse',
                data: response
            }, '*');
        }
        
        // 显示JSON内容
        document.write(`<pre style="font-family: monospace; white-space: pre;">${jsonStr}</pre>`);
        
        // 对于支持的环境，尝试设置Content-Type
        (function() {
            const headers = document.createElement('meta');
            headers.httpEquiv = 'Content-Type';
            headers.content = 'application/json; charset=utf-8';
            document.head.appendChild(headers);
        })();
    </script>
</head>
<body>
</body>
</html>
